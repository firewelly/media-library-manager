# YY Media Library

一个功能强大的跨平台视频媒体库管理软件，支持本地和NAS存储的视频文件管理。

## 🌟 主要特性

### 📁 智能文件管理
- **多文件夹支持**: 同时管理多个本地文件夹和NAS挂载点
- **自动扫描**: 智能扫描视频文件并提取元数据
- **NAS状态监控**: 实时监控NAS连接状态，离线时保护数据
- **重复文件检测**: 基于MD5哈希值智能检测和处理重复文件

### 🎬 视频信息管理
- **自动信息提取**: 使用FFmpeg自动获取视频时长、分辨率等信息
- **封面生成**: 自动生成视频封面缩略图
- **元数据编辑**: 支持编辑标题、描述、类型、年份等信息
- **批量操作**: 支持批量生成封面、计算MD5等操作

### ⭐ 智能评分系统
- **文件名解析**: 根据文件名中的感叹号自动评分
  - 无感叹号 = 0星
  - 1个感叹号 (!) = 2星
  - 2个感叹号 (!!) = 3星
  - 3个感叹号 (!!!) = 4星
  - 4个或更多感叹号 (!!!!) = 5星
- **手动评分**: 支持0-5星手动评分

### 🏷️ 标签系统
- **灵活标签**: 为视频添加自定义标签
- **标签管理**: 统一管理所有标签
- **标签筛选**: 基于标签快速筛选视频

### 📄 NFO文件支持
- **自动导入**: 支持导入NFO格式的元数据文件
- **信息解析**: 自动解析标题、描述、类型、年份、评分等信息
- **批量处理**: 支持批量导入多个NFO文件

### 🔍 搜索和筛选
- **全文搜索**: 支持标题、文件名、标签的模糊搜索
- **多维筛选**: 按星级、标签、NAS状态等条件筛选
- **实时筛选**: 输入即时显示筛选结果

### 🎬 播放功能
- **智能播放**: NAS在线时可直接播放视频
- **离线保护**: NAS离线时显示元数据但禁止播放
- **系统集成**: 使用系统默认应用播放视频

## 系统要求

- **操作系统**: macOS 10.14+、Windows 10+ 或 Linux (Ubuntu 18.04+)
- **Python**: Python 3.7 或更高版本
- **依赖库**: 详见 requirements.txt
- **FFmpeg**: 用于封面生成和视频信息获取（可选但推荐）
- **支持的视频格式**: MP4, AVI, MKV, MOV, WMV, FLV, WebM, M4V

### FFmpeg 安装

**macOS:**
```bash
brew install ffmpeg
```

**Windows:**
1. 从 [FFmpeg官网](https://ffmpeg.org/download.html) 下载
2. 解压到任意目录
3. 将 bin 目录添加到系统 PATH 环境变量

**Linux (Ubuntu/Debian):**
```bash
sudo apt-get update
sudo apt-get install ffmpeg
```

**Linux (CentOS/RHEL):**
```bash
sudo yum install epel-release
sudo yum install ffmpeg
```

## 安装和运行

1. **克隆项目**
   ```bash
   git clone https://github.com/your-username/YY_Media_Lib.git
   cd YY_Media_Lib
   ```

2. **安装依赖**
   ```bash
   pip3 install -r requirements.txt
   ```

3. **运行程序**
   ```bash
   python3 media_library.py
   ```
   
   或使用启动脚本：
   ```bash
   chmod +x start_media_library.sh
   ./start_media_library.sh
   ```

## 使用指南

### 首次使用

1. **添加文件夹**
   - 点击菜单 "文件" → "添加文件夹"
   - 选择包含视频文件的文件夹
   - 支持本地文件夹和NAS挂载点

2. **扫描媒体文件**
   - 点击菜单 "文件" → "扫描媒体文件"
   - 程序会自动扫描所有添加的文件夹
   - 扫描过程在后台进行，不会阻塞界面

### 日常使用

1. **浏览视频**
   - 在右侧视频列表中浏览所有视频
   - 点击视频查看详细信息
   - 双击视频直接播放

2. **搜索和筛选**
   - 在左侧搜索框输入关键词
   - 使用星级、标签、NAS状态筛选
   - 支持多条件组合筛选

3. **编辑视频信息**
   - 选择视频后在详情面板编辑信息
   - 修改标题、描述、标签
   - 点击"保存修改"确认更改

4. **管理标签**
   - 点击菜单 "工具" → "标签管理"
   - 添加、删除标签
   - 批量应用标签

5. **生成封面**
   - 选择视频后点击"生成封面"
   - 或使用菜单 "工具" → "批量生成封面"

## 文件命名建议

为了充分利用自动星级功能，建议按以下格式重命名您的视频文件：

```
# 普通视频（0星）
复仇者联盟.mp4
泰坦尼克号.avi

# 好看的视频（2星）
!肖申克的救赎.mp4
!阿甘正传.mkv

# 很棒的视频（3星）
!!教父.mp4
!!星际穿越.mov

# 超级棒的视频（4星）
!!!盗梦空间.mp4
!!!黑客帝国.avi

# 经典必看（5星）
!!!!公民凯恩.mp4
!!!!2001太空漫游.mkv
```

## 数据库

程序使用SQLite数据库存储所有信息，数据库文件为 `media_library.db`。首次运行时会自动创建空数据库。

### 数据库备份

建议定期备份数据库文件：
```bash
cp media_library.db media_library.db.backup_$(date +%Y%m%d_%H%M%S)
```

## 故障排除

### 常见问题

1. **FFmpeg未找到**
   - 确保已安装FFmpeg并添加到PATH
   - macOS用户可使用 `brew install ffmpeg`

2. **NAS连接问题**
   - 检查NAS是否在线
   - 确认挂载路径是否正确
   - 重新挂载NAS共享文件夹

3. **视频无法播放**
   - 检查文件是否存在
   - 确认NAS状态
   - 检查系统默认视频播放器

4. **封面生成失败**
   - 确保FFmpeg已正确安装
   - 检查视频文件是否损坏
   - 确认有足够的磁盘空间

## 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 许可证

本项目采用 BSD 3-Clause 许可证。详见 [LICENSE](LICENSE) 文件。

## 更新日志

### v1.0.0
- 初始版本发布
- 支持视频文件管理和元数据编辑
- 智能评分和标签系统
- NFO文件支持
- 封面生成功能
- NAS状态监控

---

**YY Media Library** - 让视频管理变得简单高效！